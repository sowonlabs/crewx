{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://crewx.ai/schemas/api-provider-config.json",
  "title": "CrewX API Provider Configuration",
  "description": "Schema describing inline API provider configuration blocks plus supporting tool/MCP definitions.",
  "type": "object",
  "additionalProperties": false,
  "required": ["provider", "model"],
  "properties": {
    "provider": {
      "type": "string",
      "enum": ["api/openai-compatible", "api/openai", "api/anthropic"],
      "description": "API provider identifier. Matches SDK APIProviderType."
    },
    "gateway": {
      "type": "string",
      "format": "uri",
      "description": "LiteLLM or API gateway base URL (e.g., https://litellm.example.com)."
    },
    "model": {
      "type": "string",
      "description": "Model identifier understood by the upstream provider (e.g., claude-3-5-sonnet-20241022)."
    },
    "temperature": {
      "type": "number",
      "minimum": 0,
      "maximum": 2,
      "default": 0.7,
      "description": "Sampling temperature applied to API calls."
    },
    "maxTokens": {
      "type": "integer",
      "minimum": 1,
      "description": "Upper bound for completion tokens supplied to the API."
    },
    "tools": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "uniqueItems": true,
      "description": "Tool identifiers that this agent can invoke. Tools must be defined separately as HTTP or MCP entries."
    }
  },
  "$defs": {
    "mcpServerConfig": {
      "type": "object",
      "description": "Process definition for Model Context Protocol servers.",
      "required": ["command", "args"],
      "properties": {
        "command": {
          "type": "string",
          "description": "Executable used to launch the MCP server (e.g., npx)."
        },
        "args": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Arguments passed to the command."
        },
        "env": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "description": "Environment variables injected when spawning the server."
        }
      }
    },
    "httpToolDefinition": {
      "type": "object",
      "required": ["name", "type", "endpoint"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Unique identifier for the tool."
        },
        "type": {
          "const": "http",
          "description": "Tool execution type. Local filesystem helpers are not allowed for API providers."
        },
        "endpoint": {
          "type": "string",
          "format": "uri",
          "description": "HTTP endpoint invoked when the tool is called."
        },
        "method": {
          "type": "string",
          "enum": ["GET", "POST"],
          "description": "HTTP method used for the request (default: POST)."
        },
        "headers": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "description": "Optional static headers injected into the request."
        }
      },
      "additionalProperties": false
    },
    "mcpToolDefinition": {
      "type": "object",
      "required": ["name", "type", "mcpServer"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Unique identifier for the tool."
        },
        "type": {
          "const": "mcp",
          "description": "Marks this tool as an MCP proxy tool."
        },
        "mcpServer": {
          "type": "string",
          "description": "Key referencing the MCP server entry that hosts the tool."
        },
        "headers": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "description": "Optional headers passed to the MCP transport (if supported)."
        }
      },
      "additionalProperties": false
    },
    "toolDefinition": {
      "description": "Discriminated union describing HTTP or MCP tool definitions (local file tools are disallowed for API providers).",
      "oneOf": [
        { "$ref": "#/$defs/httpToolDefinition" },
        { "$ref": "#/$defs/mcpToolDefinition" }
      ]
    }
  }
}
