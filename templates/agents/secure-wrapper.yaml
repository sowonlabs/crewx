# CrewX Secure Wrapper Layout
# Demonstrates layout-driven user_query wrapping with safety guards.

description: Secure wrapper layout for user input containers
version: 1.0.0
propsSchema:
  securityKey:
    type: string
    description: Name of the TemplateContext vars key that stores the security token
    defaultValue: security_key
  userInput:
    type: string
    description: Name of the TemplateContext vars key that carries the escaped user input
    defaultValue: user_input
layouts:
  secure-wrapper: |
    {{!--
      Security guidance:
      - vars.user_input is HTML-escaped by LayoutRenderer
      - Use triple-stash to avoid double escaping but remain safe
    --}}
    <system_prompt key="{{vars.security_key}}">
      {{{layout.system_prompt}}}
    </system_prompt>

    {{#if vars.user_input}}
    <user_query key="{{vars.security_key}}">
    {{{vars.user_input}}}
    </user_query>
    {{else}}
    {{!-- Optional fallback when user input is not provided --}}
    <user_query key="{{vars.security_key}}" missing="true" />
    {{/if}}
